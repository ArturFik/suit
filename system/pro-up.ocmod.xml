<?xml version="1.0" encoding="utf-8"?>
<modification>
    <name>PRO-UP</name>
    <version>1.0</version>
    <author>Draksc</author>
    <code>code</code>

    <!-- Подключение дополнительных стилей и скриптов -->
    <file path="catalog/controller/common/header.php">
        <operation error="skip">
            <search><![CDATA[public function index()]]></search>
            <add position="after"><![CDATA[
            // Подключение дополнительных стилей и скриптов
            $this->document->addStyle('catalog/view/theme/default/static/css/owl.carousel.css');
            $this->document->addStyle('catalog/view/theme/default/static/css/owl.theme.default.css');
            $this->document->addStyle('catalog/view/theme/default/style/main.css');
            $this->document->addStyle('catalog/view/theme/default/style/custom.css');           

			$this->document->addScript('catalog/view/theme/default/js/custom.js');
            $this->document->addScript('catalog/view/theme/default/static/js/owl.carousel.js');
            ]]>            </add>
        </operation>
    </file>
    <file path="catalog/controller/common/footer.php">
        <operation error="skip">
            <search><![CDATA[$data['scripts'] = $this->document->getScripts('footer');]]></search>
            <add position="before"><![CDATA[
            $this->document->addScript('catalog/view/theme/default/static/js/core.js', 'footer');
            $this->document->addScript('catalog/view/theme/default/js/main.js', 'footer');
            ]]></add>
        </operation>
    </file>

    <!-- Хедер -->
    <file path="catalog/controller/common/header.php">
        <operation error="skip">
            <search><![CDATA[$data['telephone'] = $this->config->get('config_telephone');]]></search>
            <add position="after"><![CDATA[
            $data['email'] = $this->config->get('config_email');
            foreach ($this->model_catalog_information->getInformations() as $result) {
                if ($result['top']) {
                    $data['informations'][] = array(
                        'title' => $result['title'],
                        'href'  => $this->url->link('information/information', 'information_id=' . $result['information_id'])
                    );
                }
            }
            $ids_category_articles = explode(',', $this->language->get('ids_category_articles'));
			$this->load->model('blog/blog_category');
			foreach($ids_category_articles as $category_articles_id){
				$blog_category_info = $this->model_blog_blog_category->getBlogCategory($category_articles_id);
				if ($blog_category_info) {
					$data['informations'][] = array(
						'title' => $blog_category_info['name'],
						'href'  => $this->url->link('blog/category', 'blogpath=' . $category_articles_id)
					);
				}
			}
            
            $data['informations'][] = array(
                'title' => $this->language->get('text_contact_n'),
                'href'  => $data['contact']
            );
            $data['compare'] = $this->url->link('product/compare');
            ]]></add>
        </operation>
    </file>

    <!-- Меню категорий -->
    <file path="catalog\controller\common\menu.php">
        <operation error="skip">
            <search><![CDATA[$categories = $this->model_catalog_category->getCategories(0);]]></search>
            <add position="replace"><![CDATA[$categories = $this->model_catalog_category->getCategories(59);]]></add>
        </operation>
    </file>

    <!-- Вывод статей в верхнем меню -->
    <file path="admin/controller/catalog/information.php">
        <operation error="skip">
            <search><![CDATA[if (isset($this->request->post['bottom']))]]></search>
            <add position="before"><![CDATA[
            if (isset($this->request->post['top'])) {
                $data['top'] = $this->request->post['top'];
            } elseif (!empty($information_info)) {
                $data['top'] = $information_info['top'];
            } else {
                $data['top'] = 0;
            }
            ]]></add>
        </operation>
    </file>
    <file path="admin/model/catalog/information.php">
        <operation error="skip">
            <search><![CDATA[bottom = '" . (isset($data['bottom']) ? (int)$data['bottom'] : 0) . "',]]></search>
            <add position="replace"><![CDATA[bottom = '" . (isset($data['bottom']) ? (int)$data['bottom'] : 0) . "', top = '" . (isset($data['top']) ? (int)$data['top'] : 0) . "',]]></add>
        </operation>
    </file>
    <file path="admin/view/template/catalog/information_form.twig">
        <operation error="skip">
            <search><![CDATA[<label class="col-sm-2 control-label" for="input-bottom"><span data-toggle="tooltip" title="{{ help_bottom }}">{{ entry_bottom }}</span></label>]]></search>
            <add position="before" offset="1"><![CDATA[
            <div class="form-group">
                <label class="col-sm-2 control-label" for="input-top"><span data-toggle="tooltip" title="{{ help_top }}">{{ entry_top }}</span></label>
                <div class="col-sm-10">
                    <div class="checkbox">
                        <label>
                            {% if top %}
                                <input type="checkbox" name="top" value="1" checked="checked" id="input-top" />
                            {% else %}
                                <input type="checkbox" name="top" value="1" id="input-top" />
                            {% endif %}
                            &nbsp;
                        </label>
                    </div>
                </div>
            </div>
            ]]></add>
        </operation>
    </file>
    <file path="admin/language/ru-ru/ru-ru.php">
        <operation error="skip">
            <search><![CDATA[$_['datepicker']]]></search>
            <add position="after"><![CDATA[
            $_['help_top'] = 'Показывать в верхней части сайта(хедер, шапка)';
            $_['entry_top'] = 'Отображать сверху';
            ]]></add>
        </operation>
    </file>

    <!-- Footer -->
    <file path="catalog/controller/common/footer.php">
        <operation error="skip">
            <search><![CDATA[$data['informations'] = array();]]></search>
            <add position="after"><![CDATA[
            $data['informations_about_us_footer'] = array();
            $data['informations_payment_footer'] = array();
            $data['informations_service_footer'] = array();
            $data['informations_special_footer'] = array();
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[if ($result['bottom'])]]></search>
            <add position="after"><![CDATA[
            if(in_array($result['information_id'], explode(',', $this->language->get('ids_informantion_about_us')))){
				$data['informations_about_us_footer'][] = array(
					'title' => $result['title'],
					'href'  => $this->url->link('information/information', 'information_id=' . $result['information_id'])
				);
			}
            if(in_array($result['information_id'], explode(',', $this->language->get('ids_informantion_payment')))){
				$data['informations_payment_footer'][] = array(
					'title' => $result['title'],
					'href'  => $this->url->link('information/information', 'information_id=' . $result['information_id'])
				);
			}
            if(in_array($result['information_id'], explode(',', $this->language->get('ids_informantion_service')))){
				$data['informations_service_footer'][] = array(
					'title' => $result['title'],
					'href'  => $this->url->link('information/information', 'information_id=' . $result['information_id'])
				);
			}
            /*if(in_array($result['information_id'], explode(',', $this->language->get('ids_informantion_special')))){
					$data['informations_special_footer'][] = array(
						'title' => $result['title'],
						'href'  => $this->url->link('information/information', 'information_id=' . $result['information_id'])
					);
				}*/
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$data['contact'] = $this->url->link('information/contact');]]></search>
            <add position="before"><![CDATA[
            $ids_informantion_special = explode(',', $this->language->get('ids_informantion_special'));
			$this->load->model('blog/blog_category');
			foreach($ids_informantion_special as $informantion_special_id){
				$blog_category_info = $this->model_blog_blog_category->getBlogCategory($informantion_special_id);
				if ($blog_category_info) {
					$data['informations_special_footer'][] = array(
						'title' => $blog_category_info['name'],
						'href'  => $this->url->link('blog/category', 'blogpath=' . $informantion_special_id)
					);
				}
			}
            $data['informations_about_us_footer'][] = array(
                'title' => $this->language->get('text_brand_footer'),
                'href'  => $this->url->link('product/manufacturer')
            );
            $data['informations_service_footer'][] = array(
                'title' => $this->language->get('text_contact_footer'),
                'href'  => $this->url->link('information/contact')
            );
            ]]></add>
        </operation>

        <operation error="skip">
            <search><![CDATA[$data['contact'] = $this->url->link('information/contact');]]></search>
            <add position="before"><![CDATA[
            $data['categories'] = array();
            $this->load->model('catalog/category');
            foreach($this->model_catalog_category->getCategoriesBottom(59) as $category){
                $data['categories'][] = array(
                    'name' => $category['name'],
                    'href' => $this->url->link('product/category', 'path=' . $category['category_id'])
                );
            }
            ]]></add>
        </operation>
    </file>


    <!-- Вывод статей и категорий в нижнем меню -->
    <file path="admin/controller/catalog/category.php">
        <operation error="skip">
            <search><![CDATA[if (isset($this->request->post['parent_id']))]]></search>
            <add position="before"><![CDATA[
            if (isset($this->request->post['bottom'])) {
                $data['bottom'] = $this->request->post['bottom'];
            } elseif (!empty($category_info)) {
                $data['bottom'] = $category_info['bottom'];
            } else {
                $data['bottom'] = 0;
            }
            ]]></add>
        </operation>
    </file>
    <file path="admin/controller/catalog/information.php">
        <operation error="skip">
            <search><![CDATA[if (isset($this->request->post['bottom']))]]></search>
            <add position="before"><![CDATA[
            if (isset($this->request->post['sort_order_bottom'])) {
                $data['sort_order_bottom'] = $this->request->post['sort_order_bottom'];
            } elseif (!empty($information_info)) {
                $data['sort_order_bottom'] = $information_info['sort_order_bottom'];
            } else {
                $data['sort_order_bottom'] = 0;
            }
            ]]></add>
        </operation>
    </file>
    <file path="admin/model/catalog/category.php">
        <operation error="skip">
            <search><![CDATA[`top` = '" . (isset($data['top']) ? (int)$data['top'] : 0) . "',]]></search>
            <add position="replace"><![CDATA[`top` = '" . (isset($data['top']) ? (int)$data['top'] : 0) . "', `bottom` = '" . (isset($data['bottom']) ? (int)$data['bottom'] : 0) . "',]]></add>
        </operation>
    </file>
    <file path="admin/model/catalog/information.php">
        <operation error="skip">
            <search><![CDATA[sort_order = '" . (int)$data['sort_order'] . "',]]></search>
            <add position="replace"><![CDATA[sort_order = '" . (int)$data['sort_order'] . "', sort_order_bottom = '" . (int)$data['sort_order_bottom'] . "',]]></add>
        </operation>
    </file>
    <file path="admin/view/template/catalog/category_form.twig">
        <operation error="skip">
            <search><![CDATA[<label class="col-sm-2 control-label" for="input-top"><span data-toggle="tooltip" title="{{ help_top }}">{{ entry_top }}</span></label>]]></search>
            <add position="before" offset="1"><![CDATA[
            <div class="form-group">
                <label class="col-sm-2 control-label" for="input-bottom"><span data-toggle="tooltip" title="{{ help_bottom_n }}">{{ entry_bottom_n }}</span></label>
                <div class="col-sm-10">
                    <div class="checkbox">
                        <label>
                            {% if bottom %}
                                <input type="checkbox" name="bottom" value="1" checked="checked" id="input-bottom" />
                            {% else %}
                                <input type="checkbox" name="bottom" value="1" id="input-bottom" />
                            {% endif %}
                            &nbsp;
                        </label>
                    </div>
                </div>
            </div>
            ]]></add>
        </operation>
    </file>
    <file path="admin/view/template/catalog/information_form.twig">
        <operation error="skip">
            <search><![CDATA[<label class="col-sm-2 control-label" for="input-status">{{ entry_status }}</label>]]></search>
            <add position="before" offset="1"><![CDATA[
            <div class="form-group">
                <label class="col-sm-2 control-label" for="input-sort-order-bottom">{{ entry_sort_order_bottom }}</label>
                <div class="col-sm-10">
                  <input type="text" name="sort_order_bottom" value="{{ sort_order_bottom }}" placeholder="{{ entry_sort_order_bottom }}" id="input-sort-order-bottom" class="form-control" />
                </div>
            </div>
            ]]></add>
        </operation>
    </file>
    <file path="admin/language/ru-ru/ru-ru.php">
        <operation error="skip">
            <search><![CDATA[$_['datepicker']]]></search>
            <add position="after"><![CDATA[
            $_['help_bottom_n'] = 'Показывать в нижней части сайта(футер, шапка)';
            $_['entry_bottom_n'] = 'Отображать снизу';

            $_['entry_sort_order_bottom'] = 'Порядок сортировка снизу';
            ]]></add>
        </operation>
    </file>
    <file path="catalog/model/catalog/category.php">
        <operation error="skip">
            <search><![CDATA[public function getCategories($parent_id = 0)]]></search>
            <add position="before"><![CDATA[
            public function getCategoriesBottom($parent_id = 0){
                $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "category c LEFT JOIN " . DB_PREFIX . "category_description cd ON (c.category_id = cd.category_id) LEFT JOIN " . DB_PREFIX . "category_to_store c2s ON (c.category_id = c2s.category_id) WHERE c.bottom = '1' AND c.parent_id = '" . (int)$parent_id . "' AND cd.language_id = '" . (int)$this->config->get('config_language_id') . "' AND c2s.store_id = '" . (int)$this->config->get('config_store_id') . "'  AND c.status = '1' ORDER BY c.sort_order, LCASE(cd.name)");

                return $query->rows;
            }
            ]]></add>
        </operation>
    </file>
    <file path="catalog/model/catalog/information.php">
        <operation error="skip">
            <search><![CDATA[public function getInformations()]]></search>
            <add position="replace"><![CDATA[public function getInformations($sort = 'sort_order')]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[ORDER BY i.sort_order]]></search>
            <add position="replace"><![CDATA[ORDER BY i.".$sort."]]></add>
        </operation>
    </file>

    <!-- Категория -->
    <file path="catalog/controller/product/category.php">
        <!-- <operation error="skip">
            <search><![CDATA[$data['categories'] = array();]]></search>
            <add position="after"><![CDATA[//]]></add>
        </operation> -->
        <operation>
            <search><![CDATA['href' => $this->url->link('product/category', 'path=' . $this->request->get['path'] . '_' . $result['category_id'] . $url)]]></search>
            <add position="before"><![CDATA[
            'thumb' => $result['image'] ? $this->model_tool_image->resize($result['image'], 60, 60) : $this->model_tool_image->resize('placeholder.png', 60, 60),
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$this->response->setOutput($this->load->view('product/category', $data));]]></search>
            <add position="replace"><![CDATA[
            if($category_info['category_id'] == 59){
				$this->response->setOutput($this->load->view('product/category_catalog', $data));
			}else{
				$this->response->setOutput($this->load->view('product/category', $data));
			}
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$parts = explode('_', (string)$this->request->get['path']);]]></search>
            <add position="after"><![CDATA[
            /* count($parts) >= 2 ? $data['show_sub_category'] = true : $data['show_sub_category'] = false; */
            ]]></add>
        </operation>
    </file>

    <!-- Цена в списке товаров -->
    <file path="catalog/controller/extension/module/featured.php">
        <operation error="skip">
            <search><![CDATA['special'     => $special,]]></search>
            <add position="after"><![CDATA[
            'price_orig'   => $product_info['price'] ? round($product_info['price']) : false,
			'special_orig' => $product_info['special'] ? round($product_info['special']) : false,
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[foreach ($products as $product_id)]]></search>
            <add position="before"><![CDATA[
            $data['symbol_right'] = $this->currency->getSymbolRight($this->session->data['currency']);
            $data['currency'] = $this->session->data['currency'];
            $data['title_module'] = $setting['name'];
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/product/category.php">
        <operation error="skip">
            <search><![CDATA['special'     => $special,]]></search>
            <add position="after"><![CDATA[
            'price_orig'   => $result['price'] ? round($result['price']) : false,
			'special_orig' => $result['special'] ? round($result['special']) : false,
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[foreach ($results as $result)]]></search>
            <add position="before"><![CDATA[
            $data['symbol_right'] = $this->currency->getSymbolRight($this->session->data['currency']);
            $data['currency'] = $this->session->data['currency'];
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/product/product.php">
        <operation error="skip">
            <search><![CDATA['special'     => $special,]]></search>
            <add position="after"><![CDATA[
            'price_orig'   => $result['price'] ? round($result['price']) : false,
			'special_orig' => $result['special'] ? round($result['special']) : false,
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[foreach ($results as $result)]]></search>
            <add position="before"><![CDATA[
            $data['symbol_right'] = $this->currency->getSymbolRight($this->session->data['currency']);
            $data['currency'] = $this->session->data['currency'];
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/account/wishlist.php">
        <operation error="skip">
            <search><![CDATA['special'    => $special,]]></search>
            <add position="after"><![CDATA[
            'price_orig'   => $product_info['price'] ? round($product_info['price']) : false,
			'special_orig' => $product_info['special'] ? round($product_info['special']) : false,
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[foreach ($results as $result)]]></search>
            <add position="before"><![CDATA[
            $data['symbol_right'] = $this->currency->getSymbolRight($this->session->data['currency']);
            $data['currency'] = $this->session->data['currency'];
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/product/search.php">
        <operation error="skip">
            <search><![CDATA['special'     => $special,]]></search>
            <add position="after"><![CDATA[
            'price_orig'   => $result['price'] ? round($result['price']) : false,
			'special_orig' => $result['special'] ? round($result['special']) : false,
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[foreach ($results as $result)]]></search>
            <add position="before"><![CDATA[
            $data['symbol_right'] = $this->currency->getSymbolRight($this->session->data['currency']);
            $data['currency'] = $this->session->data['currency'];
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/product/manufacturer.php">
        <operation error="skip">
            <search><![CDATA['special'     => $special,]]></search>
            <add position="after"><![CDATA[
            'price_orig'   => $result['price'] ? round($result['price']) : false,
			'special_orig' => $result['special'] ? round($result['special']) : false,
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[foreach ($results as $result)]]></search>
            <add position="before"><![CDATA[
            $data['symbol_right'] = $this->currency->getSymbolRight($this->session->data['currency']);
            $data['currency'] = $this->session->data['currency'];
            ]]></add>
        </operation>
    </file>

    <!-- Раздельная пагинация для админки и публичной части -->
    <file path="system/library/pagination.php">
        <operation error="skip">
            <search><![CDATA[$output = '<ul class="pagination">';]]></search>
            <add position="before"><![CDATA[
            $arr_path = explode('/admin/', $_SERVER['REQUEST_URI']);
            if (empty($arr_path[0])) {
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$output .= '</ul>';]]></search>
            <add position="after"><![CDATA[
            }else{ 
				$output = '<div class="pagination">';

				if ($page > 1) {
					$output .= '<a class="pagination__item" href="' . str_replace(array('&amp;page={page}', '?page={page}', '&page={page}'), '', $this->url) . '">' . $this->text_first . '</a>';
					
					if ($page - 1 === 1) {
						$output .= '<a class="pagination__item" href="' . str_replace(array('&amp;page={page}', '?page={page}', '&page={page}'), '', $this->url) . '">' . $this->text_prev . '</a>';
					} else {
						$output .= '<a class="pagination__item" href="' . str_replace('{page}', $page - 1, $this->url) . '">' . $this->text_prev . '</a>';
					}
				}

				if ($num_pages > 1) {
					if ($num_pages <= $num_links) {
						$start = 1;
						$end = $num_pages;
					} else {
						$start = $page - floor($num_links / 2);
						$end = $page + floor($num_links / 2);

						if ($start < 1) {
							$end += abs($start) + 1;
							$start = 1;
						}

						if ($end > $num_pages) {
							$start -= ($end - $num_pages);
							$end = $num_pages;
						}
					}

					for ($i = $start; $i <= $end; $i++) {
						if ($page == $i) {
							$output .= '<span class="pagination__item active">' . $i . '</span>';
						} else {
							if ($i === 1) {
								$output .= '<a class="pagination__item" href="' . str_replace(array('&amp;page={page}', '?page={page}', '&page={page}'), '', $this->url) . '">' . $i . '</a>';
							} else {
								$output .= '<a class="pagination__item" href="' . str_replace('{page}', $i, $this->url) . '">' . $i . '</a>';
							}
						}
					}
				}

				if ($page < $num_pages) {
					$output .= '<a class="pagination__item" href="' . str_replace('{page}', $page + 1, $this->url) . '">' . $this->text_next . '</a>';
					$output .= '<a class="pagination__item" href="' . str_replace('{page}', $num_pages, $this->url) . '">' . $this->text_last . '</a>';
				}

				$output .= '</div>';
			}
            ]]></add>
        </operation>
    </file>
    
    <!-- Модификации отзывов -->
    <file path="catalog/controller/product/extended_reviews.php">
        <operation error="skip">
            <search><![CDATA["rating" => (int) $result["rating"],]]></search>
            <add position="replace"><![CDATA["rating" => number_format((int) $result["rating"], 1, '.', ''),]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[foreach ($results as $result)]]></search>
            <add position="before"><![CDATA[
            $data['total_rate'] = 0;
            $data['count_reviews'] = array();
            $data['count_reviews']['total_5'] = 0;
            $data['count_reviews']['total_4'] = 0;
            $data['count_reviews']['total_3'] = 0;
            $data['count_reviews']['total_2'] = 0;
            $data['count_reviews']['total_1'] = 0;
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$data["reviews"][] = array]]></search>
            <add position="before"><![CDATA[
            $data['total_rate'] += (int)$result["rating"];
            if($result["rating"] == 5){
                $data['count_reviews']['total_5'] ++;
            }else if($result["rating"] == 4){
                $data['count_reviews']['total_4'] ++;
            }else if($result["rating"] == 3){
                $data['count_reviews']['total_3'] ++;
            }else if($result["rating"] == 2){
                $data['count_reviews']['total_2'] ++;
            }else if($result["rating"] == 1){
                $data['count_reviews']['total_1'] ++;
            }
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[if ($settings["captcha"])]]></search>
            <add position="before"><![CDATA[
            $data['count_reviews']['total'] = count($data["reviews"]);
            if(!empty($data['count_reviews']['total'])){
                $data['total_rate'] = number_format(round($data['total_rate']/$data['count_reviews']['total'], 1), 1, '.', '');
            }
            ]]></add>
        </operation>
    </file>

    

    <!-- Изменить text_items для корзины -->
    <file path="catalog/language/ru-ru/common/cart.php">
        <operation error="skip">
            <search><![CDATA[$_['text_items']     = 'Товаров %s (%s)';]]></search>
            <add position="replace"><![CDATA[$_['text_items'] = '%s';]]></add>
        </operation>
    </file>

    <!-- Страница успешного заказа -->
    <file path="catalog/controller/checkout/success.php">
        <operation error="skip">
            <search><![CDATA[$this->response->setOutput($this->load->view('common/success', $data));]]></search>
            <add position="replace"><![CDATA[$this->response->setOutput($this->load->view('checkout/success_order', $data));]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[unset($this->session->data['shipping_method']);]]></search>
            <add position="before"><![CDATA[
            $this->load->model('checkout/order');
			$order_info = $this->model_checkout_order->getOrder($this->session->data['order_id']);
			$data['order_info'] = array(
				'payment_method' => isset($order_info['payment_method']) ? $order_info['payment_method'] : false,
				'shipping_method' => isset($order_info['shipping_method']) ? $order_info['shipping_method'] : false,
				'heading_title' => isset($this->session->data['order_id']) ? sprintf($this->language->get('title_order_success'), $this->session->data['order_id']) : false,
			);

			if ($order_info['shipping_address_format']) {
				$format = $order_info['shipping_address_format'];
			} else {
				$format = '{firstname} {lastname}' . "\n" . '{company}' . "\n" . '{address_1}' . "\n" . '{address_2}' . "\n" . '{city} {postcode}' . "\n" . '{zone}' . "\n" . '{country}';
			}
			$find = array(
				'{firstname}',
				'{lastname}',
				'{company}',
				'{address_1}',
				'{address_2}',
				'{city}',
				'{postcode}',
				'{zone}',
				'{zone_code}',
				'{country}'
			);
	
			$replace = array(
				'firstname' => $order_info['shipping_firstname'],
				'lastname'  => $order_info['shipping_lastname'],
				'company'   => $order_info['shipping_company'],
				'address_1' => $order_info['shipping_address_1'],
				'address_2' => $order_info['shipping_address_2'],
				'city'      => $order_info['shipping_city'],
				'postcode'  => $order_info['shipping_postcode'],
				'zone'      => $order_info['shipping_zone'],
				'zone_code' => $order_info['shipping_zone_code'],
				'country'   => $order_info['shipping_country']
			);
			$data['order_info']['shipping_address'] = trim(str_replace($find, $replace, $format));
            ]]></add>
        </operation>
    </file>

    <!-- 404 -->
    <file path="catalog/language/ru-ru/error/not_found.php">
        <operation error="skip">
            <search><![CDATA[$_['heading_title'] = 'Запрашиваемая страница не найдена!';]]></search>
            <add position="replace"><![CDATA[
            $_['heading_title'] = 'Страница не существует!';
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$_['text_error']    = 'К сожалению, запрашиваемая Вами страница не найдена. Вероятно, Вы указали несуществующий адрес, страница была удалена, перемещена или сейчас она временно недоступна!';]]></search>
            <add position="replace"><![CDATA[
            $_['text_error'] = 'Данная ссылка устарела, вернитесь на главную страницу и продолжите поиск';
            ]]></add>
        </operation>
    </file>

    <!-- ЛК -->
    <file path="catalog/controller/extension/module/account.php">
        <operation error="skip">
            <search><![CDATA[$this->load->language('extension/module/account');]]></search>
            <add position="before"><![CDATA[
            if(!$this->customer->isLogged()){
                return false;
            }
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/extension/module/account.php">
        <operation error="skip">
            <search><![CDATA[$this->load->language('extension/module/account');]]></search>
            <add position="before"><![CDATA[
            $arr_path = explode('account/success', $_SERVER['REQUEST_URI']);
            if (isset($arr_path[1]) && empty($arr_path[1])) {
                return false;
            }
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[return $this->load->view('extension/module/account', $data);]]></search>
            <add position="before"><![CDATA[
            $data['address_insert'] = $this->url->link('account/simpleaddress/insert', '', true);
            $this->request->server['HTTPS'] ? $server = $this->config->get('config_ssl') : $server = $this->config->get('config_url');
		    $data['current_url'] = str_replace(':/', '://', str_replace('//', '/', $server.$this->request->server['REQUEST_URI']));
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/account/success.php">
        <operation error="skip">
            <search><![CDATA[$this->response->setOutput($this->load->view('common/success', $data));]]></search>
            <add position="replace"><![CDATA[
            $this->response->setOutput($this->load->view('account/success_account', $data));
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/account/account.php">
        <operation error="skip">
            <search><![CDATA[$this->load->language('account/account');]]></search>
            <add position="before"><![CDATA[
            $this->response->redirect($this->url->link('account/simpleedit', '', true));
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/account/address.php">
        <operation error="skip">
            <search><![CDATA['address'    => str_replace(array("\r\n", "\r", "\n"), '<br />', preg_replace(array("/\s\s+/", "/\r\r+/", "/\n\n+/"), '<br />', trim(str_replace($find, $replace, $format)))),]]></search>
            <add position="replace"><![CDATA['address'    => trim(str_replace($find, $replace, $format)),]]></add>
        </operation>
    </file>

    <!-- ЛК -->
    <file path="catalog/controller/account/logout.php">
        <operation error="skip">
            <search><![CDATA[$this->response->setOutput($this->load->view('common/success', $data));]]></search>
            <add position="replace"><![CDATA[$this->response->setOutput($this->load->view('account/logout', $data));]]></add>
        </operation>
    </file>

    <!-- Контакты -->
    <file path="catalog/controller/information/contact.php">
        <operation error="skip">
            <search><![CDATA[$data['telephone'] = $this->config->get('config_telephone');]]></search>
            <add position="after"><![CDATA[
            $data['phonelink'] = preg_replace('/\+|\s|\(|\)|\-/','', $data['telephone']);
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$data['fax'] = $this->config->get('config_fax');]]></search>
            <add position="after"><![CDATA[
            $data['phonelink'] = preg_replace('/\+|\s|\(|\)|\-/','', $data['telephone']);
            $data['email_admin'] = $this->config->get('config_email');
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$data['comment'] = $this->config->get('config_comment');]]></search>
            <add position="after"><![CDATA[
            if(isset($data['comment']) && !empty($data['comment'])){
                $data['comment'] = html_entity_decode($data['comment'], ENT_QUOTES, 'UTF-8');
            }else{
                $data['comment'] = false;
            }
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$this->response->setOutput($this->load->view('information/contact', $data));]]></search>
            <add position="before"><![CDATA[
            $formcreator = new formcreator($this->registry);
		    $data['formcreator_id41'] = $formcreator->initFeedback(41);
            ]]></add>
        </operation>
        
    </file>

    <!-- Формы -->
    <file path="catalog/controller/extension/module/formcreator.php">
        <operation error="skip">
            <search><![CDATA[$data['domain'] = $_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];]]></search>
            <add position="after"><![CDATA[
		    if($setting['module_id'] == 41){
                $data['terms_contact_form'] = sprintf($this->language->get('text_terms_contact_form_n'), $this->url->link('information/information', 'information_id=3'));
            }
            isset($setting['formcreator_modal']) ? $modal = 'modal_' : $modal = '';		
            if(is_file(DIR_TEMPLATE.'default/template/'.'extension/module/formcreator_'.$modal.$setting['module_id'].'.twig')){
                return $this->load->view('extension/module/formcreator_'.$modal.$setting['module_id'], $data);
            }
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$data['module_name'] = $setting['form_name'][$this->config->get('config_language_id')];]]></search>
            <add position="replace"><![CDATA[
            $data['module_name'] = html_entity_decode($setting['form_name'][$this->config->get('config_language_id')], ENT_QUOTES, 'UTF-8');
            ]]></add>
        </operation>
    </file>

    <!-- Заявка на рассчет -->
    <file path="catalog/controller/common/header.php">
        <operation error="skip">
            <search><![CDATA[return $this->load->view('common/header', $data);]]></search>
            <add position="before"><![CDATA[
            $formcreator = new formcreator($this->registry);
		    $data['formcreator_id42'] = $formcreator->initFeedback(42);
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/extension/module/formcreator.php">
        <operation error="skip">
            <search><![CDATA['name' => $field['name'][$this->config->get('config_language_id')],]]></search>
            <add position="replace"><![CDATA[
            'name' => html_entity_decode($field['name'][$this->config->get('config_language_id')], ENT_QUOTES, 'UTF-8'),
            ]]></add>
        </operation>
    </file>

    <!-- Список статей -->
    <file path="catalog/controller/blog/category.php">
        <operation error="skip">
            <search><![CDATA[$blog_category_info = $this->model_blog_blog_category->getBlogCategory($blog_category_id);]]></search>
            <add position="after"><![CDATA[
            $data['categories'] = array();
            $results_categories = $this->model_blog_blog_category->getBlogCategories($blog_category_id);
            foreach ($results_categories as $result) {
                $data['categories'][] = array(
                    'blog_category_id' => $result['blog_category_id'],
                    'name' => $result['name'],
                    'href' => $this->url->link('blog/category', 'blogpath='.$path.'_'.$result['blog_category_id'])
                );
            }
            ]]></add>
        </operation>
    </file>

    <!-- Детальная страница статьи -->
    <file path="catalog/controller/blog/blog.php">
        <operation error="skip">
            <search><![CDATA[if ($blog_info)]]></search>
            <add position="before"><![CDATA[
            $formcreator = new formcreator($this->registry); 
            $data['formcreator_id41'] = $formcreator->initFeedback(41);
            ]]></add>
        </operation>
    </file>

    <!-- Отзывы о мавгазине -->
    <file path="catalog/controller/extension/module/storereviews.php">
        <operation error="skip">
            <search><![CDATA['rating'      => $result['rating'],]]></search>
            <add position="replace"><![CDATA[
            'rating'      => number_format((int) $result["rating"], 1, '.', ''),
            ]]></add>
        </operation>
    </file>

    <!-- Акции через блог -->
    <file path="catalog/controller/blog/category.php">
        <operation error="skip">
            <search><![CDATA[$this->response->setOutput($this->load->view('blog/blog_category', $data));]]></search>
            <add position="replace"><![CDATA[
            if(in_array($blog_category_id, array(5,6,7))){
				// Шаблон для акций
				$this->response->setOutput($this->load->view('blog/blog_category_special', $data));
			}else{
				// Шаблон по умолчанию
				$this->response->setOutput($this->load->view('blog/blog_category', $data));
			}
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA['image' => $this->model_tool_image->resize($result['image'], $img_width, $img_height),]]></search>
            <add position="after"><![CDATA[
            'image_special' => $this->model_tool_image->resize($result['image'], 720, 209),
            ]]></add>
        </operation>
    </file>

    <!-- Изменение текста сравнения и избранного -->
    <file path="catalog/language/ru-ru/product/compare.php">
        <operation error="skip">
            <search><![CDATA[$_['text_compare']]]></search>
            <add position="replace"><![CDATA[$_['text_compare'] = '%s'; $_['text_compare_old']]]></add>
        </operation>
    </file>
    <file path="catalog/language/ru-ru/account/wishlist.php">
        <operation error="skip">
            <search><![CDATA[$_['text_wishlist']]]></search>
            <add position="replace"><![CDATA[$_['text_wishlist'] = '%s'; $_['text_wishlist_old']]]></add>
        </operation>
    </file>
    <file path="catalog/language/ru-ru/common/header.php">
        <operation error="skip">
            <search><![CDATA[$_['text_wishlist']]]></search>
            <add position="replace"><![CDATA[$_['text_wishlist'] = '%s'; $_['text_wishlist_old']]]></add>
        </operation>
    </file>

    <!-- Сравнение -->
    <file path="catalog/controller/common/header.php">
        <operation error="skip">
            <search><![CDATA[$data['compare'] = $this->url->link('product/compare');]]></search>
            <add position="after"><![CDATA[
            $data['count_compare'] = isset($this->session->data['compare']) ? count($this->session->data['compare']) : 0;
            ]]></add>
        </operation>
    </file>

    <!-- Модуль категорий -->
    <file path="catalog/controller/extension/module/category.php">
        <operation error="skip">
            <search><![CDATA[$this->load->model('catalog/category');]]></search>
            <add position="before"><![CDATA[
            if (isset($parts[2])) {
                $data['child_second_id'] = $parts[2];
            } else {
                $data['child_second_id'] = 0;
            }
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$categories = $this->model_catalog_category->getCategories(0);]]></search>
            <add position="replace"><![CDATA[
            $categories = $this->model_catalog_category->getCategories($data['category_id']);
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[if ($category['category_id'] == $data['category_id'])]]></search>
            <add position="replace"><![CDATA[
            if ($category['category_id'] == $data['child_id'])
            ]]></add>
        </operation>
    </file>

    <!-- Powered -->
    <file path="catalog/controller/common/footer.php">
        <operation error="skip">
            <search><![CDATA[return $this->load->view('common/footer', $data);]]></search>
            <add position="before"><![CDATA[
            $data["text_powered_footer_left"] = sprintf($this->language->get("text_powered_footer_left"), $this->url->link("information/information", "information_id=3", true), $this->url->link("information/information", "information_id=5", true));
            ]]></add>
        </operation>
    </file>

    <!-- Отправка файла -->
    <file path="catalog/controller/extension/module/formcreator.php">
        <operation error="skip">
            <search><![CDATA[public function index($setting)]]></search>
            <add position="before"><![CDATA[
            // Путь до папки с файлами
            private $path = DIR_IMAGE . 'oplim/';
            // Разрешенные расширения файлов.
            private $allow = array("pdf", "doc", "jpg");
            // Запрещенные расширения файлов.
            private $deny = array('phtml', 'php', 'php3', 'php4', 'php5', 'php6', 'php7', 'phps', 'cgi', 'pl', 'asp', 'aspx', 'shtml', 'shtm', 'htaccess', 'htpasswd', 'ini', 'log', 'sh', 'js', 'html', 'htm', 'css', 'sql', 'spl', 'scgi', 'fcgi', 'exe');
            // Проверка файла, без загрузки -->
            public function infoFileUpload() {
                // Название <input type="file">
                $input_name = 'file';

                $error = $success = '';
                if (!isset($_FILES[$input_name])) {
                    $error = 'Файл не загружен.';
                } else {
                    $file = $_FILES[$input_name];

                    // Проверим на ошибки загрузки.
                    if (!empty($file['error']) || empty($file['tmp_name'])) {
                        $error = 'Не удалось загрузить файл.';
                    } elseif ($file['tmp_name'] == 'none' || !is_uploaded_file($file['tmp_name'])) {
                        $error = 'Не удалось загрузить файл.';
                    } else {
                        // Оставляем в имени файла только буквы, цифры и некоторые символы.
                        $pattern = "[^a-zа-яё0-9,~!@#%^-_\$\?\(\)\{\}\[\]\.]";
                        $name = mb_eregi_replace($pattern, '-', $file['name']);
                        $name = mb_ereg_replace('[-]+', '-', $name);
                        $parts = pathinfo($name);

                        if (empty($name) || empty($parts['extension'])) {
                            $error = 'Недопустимый тип файла';
                        } elseif (!empty($this->allow) && !in_array(strtolower($parts['extension']), $this->allow)) {
                            $error = 'Недопустимый тип файла';
                        } elseif (!empty($this->deny) && in_array(strtolower($parts['extension']), $this->deny)) {
                            $error = 'Недопустимый тип файла';
                        } 
                        elseif($file['size'] > 10485760){
                            $error = 'Файл слишком большой';
                        }
                    }
                }

                // Вывод сообщения о результате загрузки.
                if (!empty($error)) {
                    $error = '<p style="color: red">' . $error . '</p>';
                }
                if (!empty($name)) {
                    $name = '<p style="color: green">' . $name . '</p>';
                }

                $data = array(
                    'name'       => $name,
                    'error'      => $error,
                );

                $this->response->addHeader('Content-Type: application/json');
                $this->response->setOutput(json_encode($data));

            }
            // Загрузка файла -->
            public function uploadFile() {
                // Название <input type="file">
                $input_name = 'file';

                $error = $success = '';
                if (!isset($_FILES[$input_name])) {
                    $error = 'Файл не загружен.';
                } else {
                    $file = $_FILES[$input_name];

                    // Проверим на ошибки загрузки.
                    if (!empty($file['error']) || empty($file['tmp_name'])) {
                        $error = 'Не удалось загрузить файл.';
                    } elseif ($file['tmp_name'] == 'none' || !is_uploaded_file($file['tmp_name'])) {
                        $error = 'Не удалось загрузить файл.';
                    } else {
                        // Оставляем в имени файла только буквы, цифры и некоторые символы.
                        $pattern = "[^a-zа-яё0-9,~!@#%^-_\$\?\(\)\{\}\[\]\.]";
                        $name = mb_eregi_replace($pattern, '-', $file['name']);
                        $name = mb_ereg_replace('[-]+', '-', $name);
                        $parts = pathinfo($name);

                        if (empty($name) || empty($parts['extension'])) {
                            $error = 'Недопустимый тип файла';
                        } elseif (!empty($this->allow) && !in_array(strtolower($parts['extension']), $this->allow)) {
                            $error = 'Недопустимый тип файла';
                        } elseif (!empty($this->deny) && in_array(strtolower($parts['extension']), $this->deny)) {
                            $error = 'Недопустимый тип файла';
                        } 
                        elseif($file['size'] > 10485760){
                            $error = 'Файл слишком большой';
                        }
                        else {
                            // Перемещаем файл в директорию.
                            if (move_uploaded_file($file['tmp_name'], $this->path . $name)) {
                                // $this->load->model('tool/image');

                                if ($this->request->server['HTTPS']) {
                                    $file_image = $this->config->get('config_ssl').'image/oplim/'.$name;
                                } else {
                                    $file_image = $this->config->get('config_url').'image/oplim/'.$name;
                                }
                                // Далее можно сохранить название файла в БД и т.п.
                                $success = '<p style="color: green">Файл «' . $name . '» успешно загружен.</p>';
                            } else {
                                $error = 'Не удалось загрузить файл.';
                            }
                        }
                    }
                }

                // Вывод сообщения о результате загрузки.
                if (!empty($error)) {
                    $error = '<p style="color: red">' . $error . '</p>';
                }

                $data = array(
                    'error'      => $error,
                    'success'    => $success,
                    'file_image' => $file_image ? $file_image : ''
                );

                $this->response->addHeader('Content-Type: application/json');
                $this->response->setOutput(json_encode($data));

            }
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$json['form_input'][$key_fields][$key_text] = $text;]]></search>
            <add position="before"><![CDATA[
            if($text == 'file'){
                $file_name = str_replace("C:\\fakepath\\", "", $json['form_input_file_hidden']);
                if(!empty($file_name)){
                    if ($this->request->server['HTTPS']) {
                        $text = $this->config->get('config_ssl').'image/oplim/' . $file_name;
                    } else {
                        $text = $this->config->get('config_url').'image/oplim/' . $file_name;
                    }
                }else{
                    $text = "Без файла";
                }							
            }           
            ]]></add>
        </operation>
    </file>

    <!-- +- кнопки -->
    <!-- Controller -->
    <file path="catalog/controller/checkout/cart.php">
        <operation>
            <search><![CDATA[public function edit()]]></search>
            <add position="replace"><![CDATA[
            public function edit(){
                $this->load->language('checkout/cart');
                $json = array();

                if (!empty($this->request->post['quantity'])) {
                    if(isset($this->request->post['key']) && !empty($this->request->post['key'])){				
                        if($this->request->post['quantity'] == 0){
                            $product_info_in_cart = $this->cart->getInfoProductInCartOnCartId($this->request->post['key']);
                            $json['product_id'] = $product_info_in_cart['product_id'];
                            $json['product_info_in_cart'] = $product_info_in_cart;
                            $json['remove'] = true;
                        }else{
                            $this->cart->update($this->request->post['key'], $this->request->post['quantity']);	
                            $product_info_in_cart = $this->cart->getInfoProductInCartOnCartId($this->request->post['key']);
                            $json['product_id'] = $product_info_in_cart['product_id'];
                            $json['cart_id'] = $product_info_in_cart['cart_id'];
                            $json['quantity'] = $product_info_in_cart['quantity'];	
                            $json['remove'] = false;						
                        }				
                    }else{
                        foreach ($this->request->post['quantity'] as $key => $value) {
                            $this->cart->update($key, $value);
                        }	
                    }

                    $this->session->data['success'] = $this->language->get('text_remove');
                }else{
                    if($this->request->post['quantity'] == 0){
                        $product_info_in_cart = $this->cart->getInfoProductInCartOnCartId($this->request->post['key']);
                        $json['product_id'] = $product_info_in_cart['product_id'];
                        $json['product_info_in_cart'] = $product_info_in_cart;
                        $json['remove'] = true;
                    }
                }

                unset($this->session->data['shipping_method']);
                unset($this->session->data['shipping_methods']);
                unset($this->session->data['payment_method']);
                unset($this->session->data['payment_methods']);
                unset($this->session->data['reward']);

                $this->response->addHeader('Content-Type: application/json');
                $this->response->setOutput(json_encode($json));
            }

            public function editOLD()
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$this->cart->add($this->request->post['product_id'], $quantity, $option, $recurring_id);]]></search>
            <add position="after"><![CDATA[
                $product_info_in_cart = $this->cart->getInfoProductInCart($this->request->post['product_id']);
                $json['product_id'] = $product_info_in_cart['product_id'];
                $json['cart_id'] = $product_info_in_cart['cart_id'];
                $json['quantity'] = $product_info_in_cart['quantity'];
            ]]></add>
        </operation>
    </file>
    <!-- Функции -->
    <file path="system/library/cart/cart.php">
        <operation error="skip">
            <search><![CDATA[public function getProducts()]]></search>
            <add position="before"><![CDATA[
            public function getProductId($key){
                foreach($this->getProducts() as $product){
                    if($product['cart_id'] == $key){
                        return $product['product_id'];
                    }
                }
            }

            public function getInfoProductInCartOnCartId($cart_id){
                $info = false;
                foreach ($this->getProducts() as $product) {
                    if($product['cart_id'] == (int)$cart_id){
                        $info = $product;
                    }
                }

                return $info;
            }

            public function getInfoProductInCart($product_id){
                $info = false;
                foreach ($this->getProducts() as $product) {
                    if($product['product_id'] == (int)$product_id){
                        $info = $product;
                    }
                }

                return $info;
            }

            public function getQuantityProductInCart($product_id){
                $quantity = 0;
                foreach ($this->getProducts() as $product) {
                    if($product['product_id'] == (int)$product_id){
                        $quantity = $product['quantity'];
                    }
                }

                return $quantity;
            }
            ]]></add>
        </operation>
    </file>
    <!-- Списки -->
    <!-- Featured -->
    <file path="catalog/controller/extension/module/featured.php">
        <operation>
            <search><![CDATA['price'       => $price,]]></search>
            <add position="after"><![CDATA[
            'product_info_in_cart' => $this->cart->getInfoProductInCart($product_info['product_id']),
            ]]></add>
        </operation>
    </file>
    <file path="catalog/view/theme/default/template/extension/module/featured.twig">
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block">]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block {% if not product.product_info_in_cart %}hidden{% endif %}">]]></add>
        </operation>
        <operation>
            <search><![CDATA[<span>{{ button_cart_n }}</span>]]></search>
            <add position="replace"><![CDATA[<span {% if product.product_info_in_cart %}class="hidden"{% endif %}>{{ button_cart_n }}</span>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<input class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="1" />]]></search>
            <add position="replace"><![CDATA[<input disabled="disabled" class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="{% if product.product_info_in_cart %}{{ product.product_info_in_cart.quantity }}{% else %}1{% endif %}" />]]></add>
        </operation>
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_plus">+</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_plus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity + 1 }}');"{% endif %}>+</div>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_minus">-</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_minus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity - 1 }}');"{% endif %}>-</div>]]></add>
        </operation>        
    </file>
    <!-- Категории -->
    <file path="catalog/controller/product/category.php">
        <operation>
            <search><![CDATA['price'       => $price,]]></search>
            <add position="after"><![CDATA[
            'product_info_in_cart' => $this->cart->getInfoProductInCart($result['product_id']),
            ]]></add>
        </operation>
    </file>
    <file path="catalog/view/theme/default/template/product/category.twig">
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block">]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block {% if not product.product_info_in_cart %}hidden{% endif %}">]]></add>
        </operation>
        <operation>
            <search><![CDATA[<span>{{ button_cart_n }}</span>]]></search>
            <add position="replace"><![CDATA[<span {% if product.product_info_in_cart %}class="hidden"{% endif %}>{{ button_cart_n }}</span>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<input class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="1" />]]></search>
            <add position="replace"><![CDATA[<input disabled="disabled" class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="{% if product.product_info_in_cart %}{{ product.product_info_in_cart.quantity }}{% else %}1{% endif %}" />]]></add>
        </operation>
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_plus">+</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_plus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity + 1 }}');"{% endif %}>+</div>]]></add>
        </operation>     
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_minus">-</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_minus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity - 1 }}');"{% endif %}>-</div>]]></add>
        </operation>     
    </file>
    <!-- Избранное -->
    <file path="catalog/controller/account/wishlist.php">
        <operation>
            <search><![CDATA['price'      => $price,]]></search>
            <add position="after"><![CDATA[
            'product_info_in_cart' => $this->cart->getInfoProductInCart($product_info['product_id']),
            ]]></add>
        </operation>        
    </file>
    <file path="catalog/view/theme/default/template/account/wishlist.twig">
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block">]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block {% if not product.product_info_in_cart %}hidden{% endif %}">]]></add>
        </operation>
        <operation>
            <search><![CDATA[<span>{{ button_cart_n }}</span>]]></search>
            <add position="replace"><![CDATA[<span {% if product.product_info_in_cart %}class="hidden"{% endif %}>{{ button_cart_n }}</span>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<input class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="1" />]]></search>
            <add position="replace"><![CDATA[<input disabled="disabled" class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="{% if product.product_info_in_cart %}{{ product.product_info_in_cart.quantity }}{% else %}1{% endif %}" />]]></add>
        </operation>
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_plus">+</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_plus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity + 1 }}');"{% endif %}>+</div>]]></add>
        </operation>  
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_minus">-</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_minus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity - 1 }}');"{% endif %}>-</div>]]></add>
        </operation>        
    </file>
    <!-- Поиск -->
    <file path="catalog/controller/product/search.php">
        <operation>
            <search><![CDATA['price'       => $price,]]></search>
            <add position="after"><![CDATA[
            'product_info_in_cart' => $this->cart->getInfoProductInCart($result['product_id']),
            ]]></add>
        </operation>
    </file>
    <file path="catalog/view/theme/default/template/product/search.twig">
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block">]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block {% if not product.product_info_in_cart %}hidden{% endif %}">]]></add>
        </operation>
        <operation>
            <search><![CDATA[<span>{{ button_cart_n }}</span>]]></search>
            <add position="replace"><![CDATA[<span {% if product.product_info_in_cart %}class="hidden"{% endif %}>{{ button_cart_n }}</span>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<input class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="1" />]]></search>
            <add position="replace"><![CDATA[<input disabled="disabled" class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="{% if product.product_info_in_cart %}{{ product.product_info_in_cart.quantity }}{% else %}1{% endif %}" />]]></add>
        </operation>
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_plus">+</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_plus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity + 1 }}');"{% endif %}>+</div>]]></add>
        </operation>  
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_minus">-</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_minus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity - 1 }}');"{% endif %}>-</div>]]></add>
        </operation>        
    </file>
    <!-- Производитель -->
    <file path="catalog/controller/product/manufacturer.php">
        <operation>
            <search><![CDATA['price'       => $price,]]></search>
            <add position="after"><![CDATA[
            'product_info_in_cart' => $this->cart->getInfoProductInCart($result['product_id']),
            ]]></add>
        </operation>
    </file> 
    <file path="catalog/view/theme/default/template/product/manufacturer_info.twig">
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block">]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block {% if not product.product_info_in_cart %}hidden{% endif %}">]]></add>
        </operation>
        <operation>
            <search><![CDATA[<span>{{ button_cart_n }}</span>]]></search>
            <add position="replace"><![CDATA[<span {% if product.product_info_in_cart %}class="hidden"{% endif %}>{{ button_cart_n }}</span>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<input class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="1" />]]></search>
            <add position="replace"><![CDATA[<input disabled="disabled" class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="{% if product.product_info_in_cart %}{{ product.product_info_in_cart.quantity }}{% else %}1{% endif %}" />]]></add>
        </operation>
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_plus">+</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_plus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity + 1 }}');"{% endif %}>+</div>]]></add>
        </operation>     
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_minus">-</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_minus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity - 1 }}');"{% endif %}>-</div>]]></add>
        </operation>     
    </file>
    <!-- Страница товара -->
    <file path="catalog/controller/product/product.php">
        <operation>
            <search><![CDATA[$discounts = $this->model_catalog_product->getProductDiscounts($this->request->get['product_id']);]]></search>
            <add position="after"><![CDATA[
            $data['product_info_in_cart'] = $this->cart->getInfoProductInCart($this->request->get['product_id']);
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA['price'       => $price,]]></search>
            <add position="after"><![CDATA[
            'product_info_in_cart' => $this->cart->getInfoProductInCart($result['product_id']),
            ]]></add>
        </operation>
    </file>
    <file path="catalog/view/theme/default/template/product/product.twig">
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block dpp">]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block dpp {% if not product_info_in_cart %}hidden{% endif %}">]]></add>
        </operation>
        <operation>
            <search><![CDATA[<input class="item-add-to-cart__input-block_input dpp" data-product-id="{{ product_id }}" value="1">]]></search>
            <add position="replace"><![CDATA[<input disabled="disabled" class="item-add-to-cart__input-block_input dpp" data-product-id="{{ product_id }}"  value="{% if product_info_in_cart %}{{ product_info_in_cart.quantity }}{% else %}1{% endif %}" />]]></add>
        </operation>
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_plus dpp">+</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_plus dpp" {% if product_info_in_cart %}onclick="cart.update('{{ product_info_in_cart.cart_id }}', '{{ product_info_in_cart.quantity + 1 }}');"{% endif %}>+</div>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_minus dpp">-</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_minus dpp" {% if product_info_in_cart %}onclick="cart.update('{{ product_info_in_cart.cart_id }}', '{{ product_info_in_cart.quantity - 1 }}');"{% endif %}>-</div>]]></add>
        </operation>

        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block">]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block {% if not product.product_info_in_cart %}hidden{% endif %}">]]></add>
        </operation>
        <operation>
            <search><![CDATA[<span>{{ button_cart_n }}</span>]]></search>
            <add position="replace"><![CDATA[<span {% if product.product_info_in_cart %}class="hidden"{% endif %}>{{ button_cart_n }}</span>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<input class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="1" />]]></search>
            <add position="replace"><![CDATA[<input disabled="disabled" class="item-add-to-cart__input-block_input" data-product-id="{{ product.product_id }}" value="{% if product.product_info_in_cart %}{{ product.product_info_in_cart.quantity }}{% else %}1{% endif %}" />]]></add>
        </operation>
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_plus">+</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_plus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity + 1 }}');"{% endif %}>+</div>]]></add>
        </operation>   
        <operation>
            <search><![CDATA[<div class="item-add-to-cart__input-block_minus">-</div>]]></search>
            <add position="replace"><![CDATA[<div class="item-add-to-cart__input-block_minus" {% if product.product_info_in_cart %}onclick="cart.update('{{ product.product_info_in_cart.cart_id }}', '{{ product.product_info_in_cart.quantity - 1 }}');"{% endif %}>-</div>]]></add>
        </operation>       
    </file>

    <!-- Текстовые переменные -->
    <!-- Catalog -->
    <file path="catalog/language/ru-ru/ru-ru.php">
        <operation error="skip">
            <search><![CDATA[$_['datepicker']]]></search>
            <add position="after"><![CDATA[
            $_['text_connection_radio'] = 'Выберите<br>способ связи:';
            $_['text_approval_radio'] = 'Нажимая на кнопку вы соглашаетесь с условиями <a href="/index.php?route=information/information&information_id=3">политики конфиденциальности</a> сайта';

            $_["empty_input_file"] = "Без файла";
            $_['text_input_file'] = 'Загрузить файл';
            $_['text_contact_n'] = 'Контакты';
            $_['palceholder_search_n'] = 'Найти на сайте или подгрузите счет конкурента';
            $_['text_catalog_n'] = 'Каталог';
            $_['text_catalog_02_n'] = 'Каталог продукции';
            $_['text_payment_request_n'] = 'Заявка на расчет';

            $_['title_about_us_footer'] = 'О компании';
            $_['title_catalog_footer'] = 'Каталог';
            $_['title_payment_footer'] = 'Получение и оплата';
            $_['title_service_footer'] = 'Сервис и поддержка';
            $_['title_work_footer'] = 'Работа у нас';
            $_['title_soc_footer'] = 'Давайте дружить';
            $_['text_brand_footer'] = 'Производители';
            $_['text_contact_footer'] = 'Обратная связь';

            $_['text_powered_footer_left'] = '<span>Вы принимаете условия <a href="%s">политики в отношении обработки персональных данных</a> и <a href="%s">пользовательского соглашения</a> каждый раз, когда оставляете свои данные в любой форме обратной связи</span>';
            $_['text_powered_footer_right'] = '<span>2010 - 2025. Все права защищены</span>';

            $_['ids_informantion_about_us'] = '10,4,11';
            $_['ids_informantion_payment'] = '6,8';
            $_['ids_informantion_service'] = '9,17';
            /*$_['ids_informantion_special'] = '7,18,19';*/
            $_['ids_informantion_special'] = '5,6,7';
            $_['ids_category_articles'] = '5,1';


            $_['fb_link'] = '#';
            $_['vk_link'] = '#';
            $_['youtube_link'] = '#';
            $_['telegram_link'] = 'https://t.me/79090177717';
            $_['whatsapp_link'] = 'https://wa.me/79090177717';

            $_['title_compare_header'] = "Сравнение";
            $_['title_wishlist_header'] = "Избранное";
            $_['title_account_header'] = "Личный кабинет";
            $_['title_cart_header'] = "Корзина";

            $_['link_category_featured'] = 'Перейти в раздел';
            $_['button_cart_n'] = 'В корзину';
            $_['text_sht_n'] = 'шт.';
            $_['text_from_n'] = 'от';

            $_['text_more_n'] = 'Подробнее';
            $_['title_reviews_product_n'] = 'Отзывы о товаре';
            $_['text_quantity_reviews'] = 'Количество отзывов:';
            $_['text_total_count_reviews'] = 'Отзывов:';
            $_['title_product_tags_n'] = 'Этот товар из подборок';
            $_['title_related_product_n'] = 'Сопутствующие товары';

            $_['title_order_success'] = 'Заказ №%s';
            $_['title_payment_method_n'] = 'Способ оплаты';
            $_['title_shipping_method_n'] = 'Способ доставки';
            $_['title_shipping_address_n'] = 'Адрес доставки';

            $_['text_logout_account_n'] = 'Выйти';
            $_['text_newsletter_account_n'] = 'Новостная рассылка';
            $_['text_order_history_account_n'] = 'История заказов';
            $_['text_wishlist_account_n'] = 'Мои закладки';
            $_['text_address_account_n'] = 'Мои адреса';
            $_['text_change_password_account_n'] = 'Изменить свой пароль';
            $_['text_account_information_account_n'] = 'Контактная информация';

            $_['text_email_n'] = 'Email';
            $_['title_legal_information_n'] = 'Юридические данные';
            $_['text_terms_contact_form_n'] = '<span>Вы соглашаетесь с <a href="%s">политикой конфиденциальности</a></span>';

            $_['text_button_submit_form_raschet_n'] = 'Отправить на расчет';

            $_['title_success_form_42_n'] = 'Ваша заявка отправлена';
            $_['sub_title_success_form_42_n'] = 'Мы получили вашу заяву и скоро свяжемся с вами';
            $_['button_close_success_form_42_n'] = 'Закрыть окно';
            ]]></add>
        </operation>
        <operation error="skip">
            <search><![CDATA[$_['text_home'] = '<i class="fa fa-home"></i>';]]></search>
            <add position="replace"><![CDATA[$_['text_home'] = 'Главная';]]></add>
        </operation>
    </file>
    <!-- Admin -->
    <!-- <file path="admin/language/ru-ru/ru-ru.php">
        <operation error="skip">
            <search><![CDATA[$_['code']]]></search>
            <add position="before"><![CDATA[
            //
            ]]></add>
        </operation>
    </file> -->

    <!-- Дириктория недоступна для записи -->
    <!-- <file path="admin\controller\marketplace\install.php">
        <operation error="skip">
            <search><![CDATA[$allowed = array(]]></search>
            <add position="after"><![CDATA[
            'admin/controller/catalog/',
			'admin/model/catalog/',
			'catalog/controller/product/',
			'catalog/model/catalog/',
            'catalog/controller/startup/',
			'admin/view/template/catalog/',
            ]]></add>
        </operation>
    </file> -->

    <!-- Google tag (gtag.js) -->
    <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-75NXPB9ZRY"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-75NXPB9ZRY');
    </script> -->

<!-- ocfilter -->
<!-- 38fe4ff4dd5d82577f040eb4a21a7a3c -->

<!-- Уровень ошибок -->
<!-- 22527 -->
</modification>